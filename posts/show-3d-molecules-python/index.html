<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Show 3D Molecules in Jupyter Notebooks | Arash</title><meta name=keywords content><meta name=description content="Recently, I have been experimenting with a Graph Neural Network (GNN) and have attempted to train it on the FS-MOL dataset. However, I have used some additional preprocessing steps that were not included in the original FSMOL dataset.
It is crucial for neural network researchers to visualize the exact input that goes in the neural network. This ensures that the input data is correct and there are no errors in the preprocessing steps that may result in faulty data."><meta name=author content><link rel=canonical href=https://athecoder.com/posts/show-3d-molecules-python/><link crossorigin=anonymous href=/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css integrity="sha256-yIlj/i15RiAA/Q+xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.b95bacdc39e37a332a9f883b1e78be4abc1fdca2bc1f2641f55e3cd3dabd4d61.js integrity="sha256-uVus3DnjejMqn4g7Hni+Srwf3KK8HyZB9V4809q9TWE=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://athecoder.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://athecoder.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://athecoder.com/favicon-32x32.png><link rel=apple-touch-icon href=https://athecoder.com/apple-touch-icon.png><link rel=mask-icon href=https://athecoder.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Show 3D Molecules in Jupyter Notebooks"><meta property="og:description" content="Recently, I have been experimenting with a Graph Neural Network (GNN) and have attempted to train it on the FS-MOL dataset. However, I have used some additional preprocessing steps that were not included in the original FSMOL dataset.
It is crucial for neural network researchers to visualize the exact input that goes in the neural network. This ensures that the input data is correct and there are no errors in the preprocessing steps that may result in faulty data."><meta property="og:type" content="article"><meta property="og:url" content="https://athecoder.com/posts/show-3d-molecules-python/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-05-06T20:41:04+03:30"><meta property="article:modified_time" content="2023-05-06T20:41:04+03:30"><meta name=twitter:card content="summary"><meta name=twitter:title content="Show 3D Molecules in Jupyter Notebooks"><meta name=twitter:description content="Recently, I have been experimenting with a Graph Neural Network (GNN) and have attempted to train it on the FS-MOL dataset. However, I have used some additional preprocessing steps that were not included in the original FSMOL dataset.
It is crucial for neural network researchers to visualize the exact input that goes in the neural network. This ensures that the input data is correct and there are no errors in the preprocessing steps that may result in faulty data."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://athecoder.com/posts/"},{"@type":"ListItem","position":3,"name":"Show 3D Molecules in Jupyter Notebooks","item":"https://athecoder.com/posts/show-3d-molecules-python/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Show 3D Molecules in Jupyter Notebooks","name":"Show 3D Molecules in Jupyter Notebooks","description":"Recently, I have been experimenting with a Graph Neural Network (GNN) and have attempted to train it on the FS-MOL dataset. However, I have used some additional preprocessing steps that were not included in the original FSMOL dataset.\nIt is crucial for neural network researchers to visualize the exact input that goes in the neural network. This ensures that the input data is correct and there are no errors in the preprocessing steps that may result in faulty data.","keywords":[],"articleBody":"Recently, I have been experimenting with a Graph Neural Network (GNN) and have attempted to train it on the FS-MOL dataset. However, I have used some additional preprocessing steps that were not included in the original FSMOL dataset.\nIt is crucial for neural network researchers to visualize the exact input that goes in the neural network. This ensures that the input data is correct and there are no errors in the preprocessing steps that may result in faulty data.\nTo depict a molecule, one common method is to use SMILES strings. First, we need to install the necessary libraries by running:\npip install rdkit ipywidgets nglview To create a 3D depiction of a molecule, we can either download a preexisting 3D depiction of a molecule from sources like PubChem or use RDKit’s built-in module to calculate 3D coordinates of atoms in a molecule represented in the SMILES format.\nRegardless of the method used, we require the nglview library to view 3D depictions of molecules in Jupyter Notebooks.\nTo demonstrate, let’s use RDKit to calculate the 3D coordinates of Remdesivir. The SMILES string for Remdesivir can be obtained from Wikipedia.\nfrom rdkit import Chem from rdkit.Chem import Draw, rdDepictor, AllChem from rdkit.Geometry import Point2D from IPython.display import display import nglview as nv smiles = 'CCC(COC(=O)[C@@H](NP(=O)(Oc1ccccc1)OC[C@H]1O[C@@]([C@@H]([C@@H]1O)O)(C#N)c1ccc2n1ncnc2N)C)CC' # The smiles string representing Remdesivir mol = Chem.MolFromSmiles(smiles) mol = Chem.AddHs(mol) AllChem.EmbedMolecule(mol) AllChem.MMFFOptimizeMolecule(mol) # Using the MMFFOptimization should result in a more accurate depiction img = Draw.MolToImage(mol) img.show() The resulting image will be a 2D structure, as the Draw module can only depict 2D structures. However, we can improve this by creating an interactive 3D depiction of Remdesivir in Jupyter Notebooks by running:\nview = nv.show_rdkit(mol) view The resulting ipywidget is a interactable 3D depiction of Remdesivir in Jupyter notebooks.\n","wordCount":"295","inLanguage":"en","datePublished":"2023-05-06T20:41:04+03:30","dateModified":"2023-05-06T20:41:04+03:30","mainEntityOfPage":{"@type":"WebPage","@id":"https://athecoder.com/posts/show-3d-molecules-python/"},"publisher":{"@type":"Organization","name":"Arash","logo":{"@type":"ImageObject","url":"https://athecoder.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://athecoder.com accesskey=h title="Arash (Alt + H)">Arash</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Show 3D Molecules in Jupyter Notebooks</h1><div class=post-meta><span title='2023-05-06 20:41:04 +0330 +0330'>May 6, 2023</span>&nbsp;·&nbsp;2 min</div></header><div class=post-content><p>Recently, I have been experimenting with a Graph Neural Network (GNN) and have attempted to train it on the <a href=https://github.com/microsoft/FS-Mol>FS-MOL dataset</a>. However, I have used some additional preprocessing steps that were not included in the original FSMOL dataset.</p><p>It is crucial for neural network researchers to visualize the exact input that goes <strong>in</strong> the neural network. This ensures that the input data is correct and there are no errors in the preprocessing steps that may result in faulty data.</p><p>To depict a molecule, one common method is to use SMILES strings. First, we need to install the necessary libraries by running:</p><pre tabindex=0><code>pip install rdkit ipywidgets nglview
</code></pre><p>To create a 3D depiction of a molecule, we can either download a preexisting 3D depiction of a molecule from sources like PubChem or use RDKit&rsquo;s built-in module to calculate 3D coordinates of atoms in a molecule represented in the SMILES format.</p><p>Regardless of the method used, we require the <code>nglview</code> library to view 3D depictions of molecules in Jupyter Notebooks.</p><p>To demonstrate, let&rsquo;s use RDKit to calculate the 3D coordinates of <a href=https://en.wikipedia.org/wiki/Remdesivir>Remdesivir</a>. The SMILES string for Remdesivir can be obtained from Wikipedia.</p><pre tabindex=0><code>from rdkit import Chem
from rdkit.Chem import Draw, rdDepictor, AllChem
from rdkit.Geometry import Point2D
from IPython.display import display
import nglview as nv

smiles = &#39;CCC(COC(=O)[C@@H](NP(=O)(Oc1ccccc1)OC[C@H]1O[C@@]([C@@H]([C@@H]1O)O)(C#N)c1ccc2n1ncnc2N)C)CC&#39; # The smiles string representing Remdesivir


mol = Chem.MolFromSmiles(smiles)
mol = Chem.AddHs(mol)
AllChem.EmbedMolecule(mol)
AllChem.MMFFOptimizeMolecule(mol) # Using the MMFFOptimization should result in a more accurate depiction


img = Draw.MolToImage(mol)

img.show()
</code></pre><p><img loading=lazy src=./remdesivir-2d.png alt="2D Depiction of Remdesivir"></p><p>The resulting image will be a 2D structure, as the <code>Draw</code> module can only depict 2D structures. However, we can improve this by creating an interactive 3D depiction of Remdesivir in Jupyter Notebooks by running:</p><pre tabindex=0><code>view = nv.show_rdkit(mol)

view
</code></pre><p><img loading=lazy src=./remdesivir-3d.png alt="3D Depiction of Remdesivir"></p><p>The resulting <em>ipywidget</em> is a interactable 3D depiction of Remdesivir in Jupyter notebooks.</p></div><footer class=post-footer></footer></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>